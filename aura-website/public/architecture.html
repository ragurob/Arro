<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Hotel Concierge Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0a0a2a;
            --blue-engine: #1a2a6c;
            --purple-engine: #4a1a6c;
            --gold-layer: #b38728;
            --glow-blue: #00c6ff;
            --glow-purple: #a044ff;
            --glow-gold: #ffd700;
            --text-light: #e0e0e0;
            --text-dark: #333333;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-light);
            overflow-x: hidden;
        }

        .glow-text-blue {
            text-shadow: 0 0 5px var(--glow-blue), 0 0 10px var(--glow-blue);
        }

        .glow-text-purple {
            text-shadow: 0 0 5px var(--glow-purple), 0 0 10px var(--glow-purple);
        }

        .glow-text-gold {
            text-shadow: 0 0 5px var(--glow-gold), 0 0 10px var(--glow-gold);
        }

        .node {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .node:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .engine-blue {
            background: linear-gradient(135deg, var(--blue-engine), #000d2e);
            box-shadow: 0 0 20px rgba(0, 198, 255, 0.2);
        }

        .engine-purple {
            background: linear-gradient(135deg, var(--purple-engine), #2a0d2e);
            box-shadow: 0 0 20px rgba(160, 68, 255, 0.2);
        }

        .layer-gold {
            background: linear-gradient(135deg, var(--gold-layer), #805d1c);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        .neural-bg {
            background-image:
                radial-gradient(circle at 20% 20%, rgba(0, 198, 255, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 80% 80%, rgba(0, 198, 255, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 50% 50%, rgba(0, 198, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .message-flow-bg {
            background-image:
                linear-gradient(rgba(160, 68, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(160, 68, 255, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        .stat-box {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background-color: white;
            box-shadow: 0 0 5px white, 0 0 10px white;
            pointer-events: none;
        }
        
        .continuous-learning-arrow {
            animation: rotate 8s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen w-full flex items-center justify-center p-4 lg:p-8">
    <div class="w-full max-w-7xl mx-auto relative">
        
        <!-- SVG Layer for Connections -->
        <svg id="connections-svg" class="absolute top-0 left-0 w-full h-full pointer-events-none" style="z-index: 1;"></svg>

        <!-- Main Layout -->
        <div class="relative space-y-8" style="z-index: 2;">

            <!-- TOP LAYER: Guest Touchpoints -->
            <div id="guest-touchpoints" class="text-center">
                <h2 class="text-xl lg:text-2xl font-bold mb-6 glow-text-gold">Guest Touchpoints</h2>
                <div class="grid grid-cols-3 sm:grid-cols-5 gap-4 lg:gap-8">
                    <!-- WhatsApp -->
                    <div id="touchpoint-whatsapp" class="node flex flex-col items-center p-4 rounded-xl">
                        <svg class="w-8 h-8 lg:w-10 lg:h-10 text-green-400" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.398 1.908 6.161l-1.217 4.432 4.515-1.185z"/></svg>
                        <span class="mt-2 text-sm lg:text-base">WhatsApp</span>
                    </div>
                    <!-- SMS -->
                    <div id="touchpoint-sms" class="node flex flex-col items-center p-4 rounded-xl">
                        <svg class="w-8 h-8 lg:w-10 lg:h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                        <span class="mt-2 text-sm lg:text-base">SMS</span>
                    </div>
                    <!-- Email -->
                    <div id="touchpoint-email" class="node flex flex-col items-center p-4 rounded-xl">
                        <svg class="w-8 h-8 lg:w-10 lg:h-10 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        <span class="mt-2 text-sm lg:text-base">Email</span>
                    </div>
                    <!-- Web Chat -->
                    <div id="touchpoint-web" class="node flex flex-col items-center p-4 rounded-xl">
                        <svg class="w-8 h-8 lg:w-10 lg:h-10 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m0 0a9 9 0 019-9m-9 9a9 9 0 009 9"></path></svg>
                        <span class="mt-2 text-sm lg:text-base">Web Chat</span>
                    </div>
                    <!-- Phone -->
                    <div id="touchpoint-phone" class="node flex flex-col items-center p-4 rounded-xl">
                        <svg class="w-8 h-8 lg:w-10 lg:h-10 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                        <span class="mt-2 text-sm lg:text-base">Phone</span>
                    </div>
                </div>
            </div>

            <!-- MIDDLE LAYER -->
            <div id="middle-layer" class="flex flex-col lg:flex-row items-stretch justify-center gap-4 lg:gap-8">
                <!-- Memory Engine -->
                <div id="memory-engine" class="engine-blue neural-bg w-full lg:w-2/5 p-6 rounded-2xl border border-blue-400/50 flex flex-col justify-between">
                    <h3 class="text-lg lg:text-xl font-bold text-center mb-6 glow-text-blue">Memory Engine</h3>
                    <div class="grid grid-cols-2 gap-4 flex-grow">
                        <div id="node-dna" class="node p-3 rounded-lg flex flex-col items-center justify-center text-center">
                            <svg class="w-7 h-7 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Guest DNA Profiles</span>
                        </div>
                        <div id="node-kb" class="node p-3 rounded-lg flex flex-col items-center justify-center text-center">
                            <svg class="w-7 h-7 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V21H9z"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Property Knowledge Base</span>
                        </div>
                        <div id="node-patterns" class="node p-3 rounded-lg flex flex-col items-center justify-center text-center">
                            <svg class="w-7 h-7 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Historical Patterns</span>
                        </div>
                        <div id="node-predictive" class="node p-3 rounded-lg flex flex-col items-center justify-center text-center">
                            <svg class="w-7 h-7 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7.014A8.003 8.003 0 0112 3c1.398 0 2.743.57 3.714 1.543C18.5 6.5 19 9 19 10c2 1 2.657 1.343 2.657 1.343a8 8 0 01-4.001 7.314zM12 21a9.004 9.004 0 008.657-6.343"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Predictive Models</span>
                        </div>
                    </div>
                </div>

                <!-- Augmentation Layer -->
                <div id="augmentation-layer" class="layer-gold w-full lg:w-1/5 p-4 rounded-2xl border border-yellow-400/50 flex flex-col items-center justify-center">
                    <h3 class="text-lg lg:text-xl font-bold text-center mb-4 glow-text-gold">Augmentation Layer</h3>
                    <div class="relative flex flex-col items-center justify-center space-y-4">
                        <div id="human-enhancement" class="flex flex-col items-center text-center">
                            <svg class="w-10 h-10 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="text-sm font-semibold">Human Enhancement Point</span>
                        </div>
                        <div id="learning-loop-icon" class="relative w-20 h-20 mt-4">
                            <svg class="w-full h-full text-white/80 continuous-learning-arrow" viewBox="0 0 100 100"><path d="M 50,10 A 40,40 0 1 1 25.4,82.4 L 10,90 L 17.6,74.6 A 40,40 0 0 1 50,10 Z" stroke="currentColor" stroke-width="8" fill="none" /></svg>
                            <span class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xs font-bold">LEARN</span>
                        </div>
                    </div>
                </div>

                <!-- Communication Hub -->
                <div id="communication-hub" class="engine-purple message-flow-bg w-full lg:w-2/5 p-6 rounded-2xl border border-purple-400/50 flex flex-col justify-between">
                    <h3 class="text-lg lg:text-xl font-bold text-center mb-6 glow-text-purple">Communication Hub</h3>
                    <div class="space-y-4 flex-grow flex flex-col justify-around">
                        <div id="node-intent" class="node p-3 rounded-lg flex items-center space-x-3">
                            <svg class="w-7 h-7 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 16.663c.527-.527.928-1.146 1.221-1.812M14.337 16.663a12.024 12.024 0 00-4.675 0M12 17.75V21M9 3H5a2 2 0 00-2 2v4m14-6h-4a2 2 0 00-2 2v4m0 0a2 2 0 01-2 2h-2a2 2 0 01-2-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2m-6 9v-3a2 2 0 00-2-2H9a2 2 0 00-2 2v3"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Intent Recognition</span>
                        </div>
                        <div id="node-complexity" class="node p-3 rounded-lg flex items-center space-x-3">
                            <svg class="w-7 h-7 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Complexity Scoring</span>
                        </div>
                        <div id="node-routing" class="node p-3 rounded-lg flex items-center space-x-3">
                            <svg class="w-7 h-7 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.368a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Smart Routing</span>
                        </div>
                        <div id="node-response" class="node p-3 rounded-lg flex items-center space-x-3">
                            <svg class="w-7 h-7 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                            <span class="text-xs lg:text-sm font-medium">Response Generation</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOTTOM LAYER: Action Outputs -->
            <div id="action-outputs" class="text-center">
                <h2 class="text-xl lg:text-2xl font-bold mt-8 mb-6 glow-text-gold">Action Outputs</h2>
                <div class="grid grid-cols-3 sm:grid-cols-5 gap-4 lg:gap-8">
                    <div id="output-response" class="node flex flex-col items-center p-4 rounded-xl">
                        <span class="font-semibold text-sm lg:text-base">Guest Response</span>
                    </div>
                    <div id="output-booking" class="node flex flex-col items-center p-4 rounded-xl">
                        <span class="font-semibold text-sm lg:text-base">Booking System</span>
                    </div>
                    <div id="output-alert" class="node flex flex-col items-center p-4 rounded-xl">
                        <span class="font-semibold text-sm lg:text-base">Staff Alert</span>
                    </div>
                    <div id="output-analytics" class="node flex flex-col items-center p-4 rounded-xl">
                        <span class="font-semibold text-sm lg:text-base">Analytics</span>
                    </div>
                    <div id="output-loop" class="node flex flex-col items-center p-4 rounded-xl">
                        <span class="font-semibold text-sm lg:text-base">Learning Loop</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const svg = document.getElementById('connections-svg');
            const particleContainer = document.body;
            let paths = [];

            const colors = {
                touchpoint: 'rgba(255, 215, 0, 0.7)', // gold
                memory: 'rgba(0, 198, 255, 0.7)', // blue
                comm: 'rgba(160, 68, 255, 0.7)', // purple
                augment: 'rgba(255, 215, 0, 0.7)', // gold
                output: 'rgba(255, 215, 0, 0.7)', // gold
            };

            const getCenter = (el) => {
                if (!el) return { x: 0, y: 0 };
                const rect = el.getBoundingClientRect();
                const containerRect = el.closest('.w-full.max-w-7xl').getBoundingClientRect();
                return {
                    x: rect.left + rect.width / 2 - containerRect.left,
                    y: rect.top + rect.height / 2 - containerRect.top
                };
            };
            
            const getEdge = (el, side) => {
                if (!el) return { x: 0, y: 0 };
                const rect = el.getBoundingClientRect();
                const containerRect = el.closest('.w-full.max-w-7xl').getBoundingClientRect();
                const x = rect.left - containerRect.left;
                const y = rect.top - containerRect.top;
                
                switch(side) {
                    case 'top': return { x: x + rect.width / 2, y: y };
                    case 'bottom': return { x: x + rect.width / 2, y: y + rect.height };
                    case 'left': return { x: x, y: y + rect.height / 2 };
                    case 'right': return { x: x + rect.width, y: y + rect.height / 2 };
                    default: return getCenter(el);
                }
            };

            const createPath = (startEl, endEl, startSide, endSide, color, dashed = false, curve = 0.5) => {
                const start = getEdge(startEl, startSide);
                const end = getEdge(endEl, endSide);

                const dx = end.x - start.x;
                const dy = end.y - start.y;
                
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                let d;
                if (startSide === 'bottom' || startSide === 'top') {
                    d = `M ${start.x} ${start.y} C ${start.x} ${start.y + dy * curve}, ${end.x} ${end.y - dy * curve}, ${end.x} ${end.y}`;
                } else {
                    d = `M ${start.x} ${start.y} C ${start.x + dx * curve} ${start.y}, ${end.x - dx * curve} ${end.y}, ${end.x} ${end.y}`;
                }
                
                path.setAttribute('d', d);
                path.setAttribute('fill', 'none');
                path.setAttribute('stroke', color);
                path.setAttribute('stroke-width', '2');
                path.setAttribute('stroke-linecap', 'round');
                
                const glow = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                glow.setAttribute('d', d);
                glow.setAttribute('fill', 'none');
                glow.setAttribute('stroke', color);
                glow.setAttribute('stroke-width', '6');
                glow.setAttribute('stroke-opacity', '0.3');
                glow.style.filter = 'blur(4px)';

                if (dashed) {
                    path.setAttribute('stroke-dasharray', '5, 5');
                }

                svg.appendChild(glow);
                svg.appendChild(path);

                return path;
            };
            
            const createArrowHead = (path, color) => {
                const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
                const markerId = `arrowhead-${Math.random().toString(36).substr(2, 9)}`;
                marker.setAttribute('id', markerId);
                marker.setAttribute('viewBox', '0 0 10 10');
                marker.setAttribute('refX', '8');
                marker.setAttribute('refY', '5');
                marker.setAttribute('markerWidth', '6');
                marker.setAttribute('markerHeight', '6');
                marker.setAttribute('orient', 'auto-start-reverse');

                const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                polygon.setAttribute('points', '0 0, 10 5, 0 10');
                polygon.setAttribute('fill', color);
                
                marker.appendChild(polygon);
                svg.querySelector('defs').appendChild(marker);
                path.setAttribute('marker-end', `url(#${markerId})`);
            };

            const drawConnections = () => {
                svg.innerHTML = '<defs></defs>'; // Clear previous paths
                paths = [];

                const touchpoints = [
                    document.getElementById('touchpoint-whatsapp'),
                    document.getElementById('touchpoint-sms'),
                    document.getElementById('touchpoint-email'),
                    document.getElementById('touchpoint-web'),
                    document.getElementById('touchpoint-phone'),
                ];
                
                const memoryEngine = document.getElementById('memory-engine');
                const commHub = document.getElementById('communication-hub');
                const augmentationLayer = document.getElementById('augmentation-layer');

                // Touchpoints to Engines
                touchpoints.forEach(tp => {
                    paths.push({ path: createPath(tp, memoryEngine, 'bottom', 'top', colors.touchpoint), color: colors.touchpoint, hasArrow: true });
                    paths.push({ path: createPath(tp, commHub, 'bottom', 'top', colors.touchpoint), color: colors.touchpoint, hasArrow: true });
                });
                
                // Memory Engine internal connections
                const memoryNodes = [
                    document.getElementById('node-dna'),
                    document.getElementById('node-kb'),
                    document.getElementById('node-patterns'),
                    document.getElementById('node-predictive')
                ];
                for (let i = 0; i < memoryNodes.length; i++) {
                    for (let j = i + 1; j < memoryNodes.length; j++) {
                        paths.push({ path: createPath(memoryNodes[i], memoryNodes[j], 'right', 'left', colors.memory, true, 0.2), color: colors.memory });
                    }
                }

                // Communication Hub sequential flow
                const commNodes = [
                    document.getElementById('node-intent'),
                    document.getElementById('node-complexity'),
                    document.getElementById('node-routing'),
                    document.getElementById('node-response')
                ];
                for (let i = 0; i < commNodes.length - 1; i++) {
                    paths.push({ path: createPath(commNodes[i], commNodes[i+1], 'bottom', 'top', colors.comm), color: colors.comm, hasArrow: true });
                }

                // Bridge connections
                paths.push({ path: createPath(memoryEngine, augmentationLayer, 'right', 'left', colors.augment), color: colors.augment, hasArrow: true });
                paths.push({ path: createPath(augmentationLayer, memoryEngine, 'left', 'right', colors.augment), color: colors.augment, hasArrow: true });
                paths.push({ path: createPath(commHub, augmentationLayer, 'left', 'right', colors.augment), color: colors.augment, hasArrow: true });
                paths.push({ path: createPath(augmentationLayer, commHub, 'right', 'left', colors.augment), color: colors.augment, hasArrow: true });

                // Output connections
                const outputs = [
                    document.getElementById('output-response'),
                    document.getElementById('output-booking'),
                    document.getElementById('output-alert'),
                    document.getElementById('output-analytics'),
                    document.getElementById('output-loop'),
                ];
                
                const humanEnhancement = document.getElementById('human-enhancement');
                const nodeResponse = document.getElementById('node-response');
                const nodeRouting = document.getElementById('node-routing');
                const learningLoopIcon = document.getElementById('learning-loop-icon');

                paths.push({ path: createPath(nodeResponse, outputs[0], 'bottom', 'top', colors.output), color: colors.output, hasArrow: true });
                paths.push({ path: createPath(nodeResponse, outputs[1], 'bottom', 'top', colors.output), color: colors.output, hasArrow: true });
                paths.push({ path: createPath(nodeRouting, outputs[2], 'bottom', 'top', colors.output), color: colors.output, hasArrow: true });
                paths.push({ path: createPath(memoryEngine, outputs[3], 'bottom', 'top', colors.output), color: colors.output, hasArrow: true });
                paths.push({ path: createPath(augmentationLayer, outputs[4], 'bottom', 'top', colors.output), color: colors.output, hasArrow: true });
                
                // Add arrowheads
                paths.forEach(p => {
                    if (p.hasArrow) {
                        createArrowHead(p.path, p.color);
                    }
                });

                startParticleAnimation();
            };

            let particles = [];
            function startParticleAnimation() {
                // Clear existing particles
                document.querySelectorAll('.particle').forEach(p => p.remove());
                particles = [];

                paths.forEach(({path, color}) => {
                    const numParticles = Math.floor(path.getTotalLength() / 50);
                    for (let i = 0; i < numParticles; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.backgroundColor = color;
                        particle.style.width = '3px';
                        particle.style.height = '3px';
                        particleContainer.appendChild(particle);
                        
                        particles.push({
                            path: path,
                            element: particle,
                            progress: i / numParticles,
                            speed: 0.001 + Math.random() * 0.001
                        });
                    }
                });
            }

            function animateParticles() {
                particles.forEach(p => {
                    p.progress += p.speed;
                    if (p.progress > 1) {
                        p.progress = 0;
                    }
                    const point = p.path.getPointAtLength(p.progress * p.path.getTotalLength());
                    p.element.style.transform = `translate(${point.x - 1.5}px, ${point.y - 1.5}px)`;
                });
                requestAnimationFrame(animateParticles);
            }

            // Initial draw and setup
            // A short delay ensures all elements are rendered and have correct dimensions
            setTimeout(() => {
                drawConnections();
                animateParticles();
            }, 100);

            // Redraw on window resize
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(drawConnections, 250);
            });
        });
    </script>
</body>
</html>